<!DOCTYPE html>
<html lang="en-GB">

<head>
<meta charset="utf-8"/>
<title>Get new character blocks</title>
<meta name="description" content="Generate character sections for block doc."/>

<link rel="stylesheet" href="local.css" type="text/css" />

<script src="../../uniview/descriptions.js"></script> 
<script src="../../uniview/u.js"></script> 
</head>

<body>
<h1>Generate block page stubs</h1>
<p>Produces stubs for codepoint descriptions in character notes pages.</p>
<p>Add a space-separated list of characters, a block at a time, from UniView. 
<button onclick="document.getElementById('listin').value = ''";document.getElementById('listin').focus()>Clear</button></p>

<p><textarea id="listin" placeholder="Add a list of characters here." style="height:400px;width:100%;"></textarea></p>

<p>
<button style="font-size: 150%;" onClick="
document.getElementById('out').value = makeListFromChars(document.getElementById('listin').value); 
document.getElementById('out').select()">Go</button>
</p>

<textarea id="out" style="height:600px;width:100%;"></textarea>




<script>

function makeListFromChars (chars) {
	var charList = chars.split(' ')
        
    charList = charList.sort()
    
	var out = ''
	
    for (var x=0; x<charList.length; x++) {
        if (charList[x] == '') continue
        var items = charList[x].split('\t')
        
        // get code point value, converting escapes if necessary
        if (items[0].includes('&#x')) {
            items[0] = items[0].replace('&#x','').replace(';','')
            i = parseInt(items[0],16)
            }
		else i = items[0].codePointAt(0)
		console.log('i',i, 'items',items)

		if (U[i]) {                 
			var hex = i.toString(16).toUpperCase()
			while (hex.length < 4) hex = '0' + hex
			console.log(hex)
			var dbrecord = U[i].split(';')
			var cpName = dbrecord[1]
			
			out += '<div class="character" id="char'+hex+'"></div>\n\n'
			}
		}
	return out
	}

</script>

</body>
</html>
